please carefully review your generated code and validate for its completeness and accuracy, test and simulate it to identify and fix any coding or logic error. finally create for me a *complete* updated version that is fully tested working and can work as is without me having to edit it further.
